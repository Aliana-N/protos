syntax = "proto3";

package auto;

option go_package="tuzov.sso.v1;ssov1";

service Auth{
    rpc Register (RegisterRequest) returns (RegisterResponse);
    rpc Login(LoginRequest) returns (LoginResponse);
    rpc IsAdmin(IsAdminRequest) returns (IsAdminResponse);
    
}
 
message RegisterRequest{
    string email=1;
    string password=2;
}

message RegisterResponse{
    int64 user_id=1;
}

message LoginRequest{
    string email=1;
    string password=2;
    int32 app_id=3;
}

message LoginResponse{
    string token=1;
}

message IsAdminRequest{
    int64 user_id=1;
}

message IsAdminResponse{
    bool is_admin=1;
}

service Permission{
    rpc DeleteUser(DeleteUserRequest) returns (DeleteUserResponse);
    rpc EditRole(EditRoleRequest) returns (EditRoleResponse);
    rpc EditLogin(EditLoginRequest) returns (EditLoginResponse);
}

message DeleteUserRequest{
    string token=1;
    int64 user_id=2;
}

message DeleteUserResponse{
    string result=1;
}

message EditRoleRequest{
    string token=1;
    int64 user_id=2;
}

message EditRoleResponse{
    string result=1;
}

message EditLoginRequest{
    string token=1;
    int64 user_id=2;   
}

message EditLoginResponse{
    string result=1;
}